Query(
  Lambda(
    ["endpoint"],
    {"data": 
      {"count": Count(
        Select(["data"],
          Map(
            Paginate(
              Match(
                Index("pushNotificationByEndpoint"), 
                Var("endpoint")
              )
            ),
            Lambda('r',
              Select(
                ["data"],
                Delete(Var('r'))
              )
            )
          )
        )
      )} 
    }
  )
)